2024-11-30:19:43:41,765 INFO     [__main__.py:279] Verbosity set to INFO
2024-11-30:19:44:01,640 INFO     [__main__.py:364] Passed `--trust_remote_code`, setting environment variable `HF_DATASETS_TRUST_REMOTE_CODE=true`
2024-11-30:19:44:01,641 INFO     [__main__.py:376] Selected Tasks: ['leaderboard_bbh_formal_fallacies']
2024-11-30:19:44:01,654 INFO     [evaluator.py:164] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2024-11-30:19:44:01,654 INFO     [evaluator.py:201] Initializing hf model, with arguments: {'pretrained': 'Qwen/Qwen2.5-0.5B', 'trust_remote_code': True}
2024-11-30:19:44:01,783 WARNING  [other.py:330] Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
2024-11-30:19:44:01,783 INFO     [huggingface.py:131] Using device 'cuda'
2024-11-30:19:44:02,349 INFO     [huggingface.py:368] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}

Generating test split:   0%|                                                                                                                   | 0/250 [00:00<?, ? examples/s]
Generating test split: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 250/250 [00:00<00:00, 20720.80 examples/s]
2024-11-30:19:44:22,108 INFO     [task.py:415] Building contexts for leaderboard_bbh_formal_fallacies on rank 0...

  0%|                                                                                                                                                 | 0/250 [00:00<?, ?it/s]
 13%|█████████████████▎                                                                                                                     | 32/250 [00:00<00:00, 313.13it/s]
 28%|█████████████████████████████████████▊                                                                                                 | 70/250 [00:00<00:00, 350.84it/s]
 44%|██████████████████████████████████████████████████████████▉                                                                           | 110/250 [00:00<00:00, 370.84it/s]
 60%|████████████████████████████████████████████████████████████████████████████████▍                                                     | 150/250 [00:00<00:00, 379.21it/s]
 76%|█████████████████████████████████████████████████████████████████████████████████████████████████████▊                                | 190/250 [00:00<00:00, 384.97it/s]
 92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋           | 229/250 [00:00<00:00, 383.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 250/250 [00:00<00:00, 377.13it/s]
2024-11-30:19:44:22,782 INFO     [evaluator.py:496] Running loglikelihood requests

Running loglikelihood requests:   0%|                                                                                                                 | 0/500 [00:00<?, ?it/s]
Running loglikelihood requests:   0%|▏                                                                                                        | 1/500 [00:00<05:11,  1.60it/s]
Running loglikelihood requests:   2%|█▉                                                                                                       | 9/500 [00:00<00:41, 11.92it/s]
Running loglikelihood requests:   3%|███▌                                                                                                    | 17/500 [00:01<00:27, 17.52it/s]
Running loglikelihood requests:   5%|█████▏                                                                                                  | 25/500 [00:01<00:22, 20.88it/s]
Running loglikelihood requests:   7%|██████▊                                                                                                 | 33/500 [00:01<00:20, 23.13it/s]
Running loglikelihood requests:   8%|████████▌                                                                                               | 41/500 [00:02<00:18, 24.64it/s]
Running loglikelihood requests:  10%|██████████▏                                                                                             | 49/500 [00:02<00:17, 25.69it/s]
Running loglikelihood requests:  11%|███████████▊                                                                                            | 57/500 [00:02<00:16, 26.66it/s]
Running loglikelihood requests:  13%|█████████████▌                                                                                          | 65/500 [00:02<00:15, 27.35it/s]
Running loglikelihood requests:  15%|███████████████▏                                                                                        | 73/500 [00:03<00:15, 27.89it/s]
Running loglikelihood requests:  16%|████████████████▊                                                                                       | 81/500 [00:03<00:14, 28.27it/s]
Running loglikelihood requests:  18%|██████████████████▌                                                                                     | 89/500 [00:03<00:14, 28.48it/s]
Running loglikelihood requests:  19%|████████████████████▏                                                                                   | 97/500 [00:04<00:14, 28.64it/s]
Running loglikelihood requests:  21%|█████████████████████▋                                                                                 | 105/500 [00:04<00:13, 28.77it/s]
Running loglikelihood requests:  23%|███████████████████████▎                                                                               | 113/500 [00:04<00:13, 28.91it/s]
Running loglikelihood requests:  24%|████████████████████████▉                                                                              | 121/500 [00:04<00:13, 28.98it/s]
Running loglikelihood requests:  26%|██████████████████████████▌                                                                            | 129/500 [00:05<00:12, 29.27it/s]
Running loglikelihood requests:  27%|████████████████████████████▏                                                                          | 137/500 [00:05<00:12, 29.45it/s]
Running loglikelihood requests:  29%|█████████████████████████████▊                                                                         | 145/500 [00:05<00:12, 29.50it/s]
Running loglikelihood requests:  31%|███████████████████████████████▌                                                                       | 153/500 [00:05<00:11, 29.47it/s]
Running loglikelihood requests:  32%|█████████████████████████████████▏                                                                     | 161/500 [00:06<00:11, 29.54it/s]
Running loglikelihood requests:  34%|██████████████████████████████████▊                                                                    | 169/500 [00:06<00:11, 29.61it/s]
Running loglikelihood requests:  35%|████████████████████████████████████▍                                                                  | 177/500 [00:06<00:10, 29.65it/s]
Running loglikelihood requests:  37%|██████████████████████████████████████                                                                 | 185/500 [00:06<00:10, 29.77it/s]
Running loglikelihood requests:  39%|███████████████████████████████████████▊                                                               | 193/500 [00:07<00:10, 29.80it/s]
Running loglikelihood requests:  40%|█████████████████████████████████████████▍                                                             | 201/500 [00:07<00:10, 29.75it/s]
Running loglikelihood requests:  42%|███████████████████████████████████████████                                                            | 209/500 [00:07<00:09, 29.76it/s]
Running loglikelihood requests:  43%|████████████████████████████████████████████▋                                                          | 217/500 [00:08<00:09, 29.81it/s]
Running loglikelihood requests:  45%|██████████████████████████████████████████████▎                                                        | 225/500 [00:08<00:09, 29.80it/s]
Running loglikelihood requests:  47%|███████████████████████████████████████████████▉                                                       | 233/500 [00:08<00:08, 29.84it/s]
Running loglikelihood requests:  48%|█████████████████████████████████████████████████▋                                                     | 241/500 [00:08<00:08, 29.83it/s]
Running loglikelihood requests:  50%|███████████████████████████████████████████████████▎                                                   | 249/500 [00:09<00:08, 30.02it/s]
Running loglikelihood requests:  51%|████████████████████████████████████████████████████▉                                                  | 257/500 [00:09<00:08, 30.19it/s]
Running loglikelihood requests:  53%|██████████████████████████████████████████████████████▌                                                | 265/500 [00:09<00:07, 30.28it/s]
Running loglikelihood requests:  55%|████████████████████████████████████████████████████████▏                                              | 273/500 [00:09<00:07, 30.40it/s]
Running loglikelihood requests:  56%|█████████████████████████████████████████████████████████▉                                             | 281/500 [00:10<00:07, 30.45it/s]
Running loglikelihood requests:  58%|███████████████████████████████████████████████████████████▌                                           | 289/500 [00:10<00:06, 30.48it/s]
Running loglikelihood requests:  59%|█████████████████████████████████████████████████████████████▏                                         | 297/500 [00:10<00:06, 30.55it/s]
Running loglikelihood requests:  61%|██████████████████████████████████████████████████████████████▊                                        | 305/500 [00:10<00:06, 30.58it/s]
Running loglikelihood requests:  63%|████████████████████████████████████████████████████████████████▍                                      | 313/500 [00:11<00:06, 30.60it/s]
Running loglikelihood requests:  64%|██████████████████████████████████████████████████████████████████▏                                    | 321/500 [00:11<00:05, 30.65it/s]
Running loglikelihood requests:  66%|███████████████████████████████████████████████████████████████████▊                                   | 329/500 [00:11<00:05, 30.63it/s]
Running loglikelihood requests:  67%|█████████████████████████████████████████████████████████████████████▍                                 | 337/500 [00:12<00:05, 30.63it/s]
Running loglikelihood requests:  69%|███████████████████████████████████████████████████████████████████████                                | 345/500 [00:12<00:05, 30.65it/s]
Running loglikelihood requests:  71%|████████████████████████████████████████████████████████████████████████▋                              | 353/500 [00:12<00:04, 30.67it/s]
Running loglikelihood requests:  72%|██████████████████████████████████████████████████████████████████████████▎                            | 361/500 [00:12<00:04, 30.84it/s]
Running loglikelihood requests:  74%|████████████████████████████████████████████████████████████████████████████                           | 369/500 [00:13<00:04, 30.97it/s]
Running loglikelihood requests:  75%|█████████████████████████████████████████████████████████████████████████████▋                         | 377/500 [00:13<00:03, 31.07it/s]
Running loglikelihood requests:  77%|███████████████████████████████████████████████████████████████████████████████▎                       | 385/500 [00:13<00:03, 31.13it/s]
Running loglikelihood requests:  79%|████████████████████████████████████████████████████████████████████████████████▉                      | 393/500 [00:13<00:03, 31.13it/s]
Running loglikelihood requests:  80%|██████████████████████████████████████████████████████████████████████████████████▌                    | 401/500 [00:14<00:03, 31.18it/s]
Running loglikelihood requests:  82%|████████████████████████████████████████████████████████████████████████████████████▎                  | 409/500 [00:14<00:02, 31.18it/s]
Running loglikelihood requests:  83%|█████████████████████████████████████████████████████████████████████████████████████▉                 | 417/500 [00:14<00:02, 31.23it/s]
Running loglikelihood requests:  85%|███████████████████████████████████████████████████████████████████████████████████████▌               | 425/500 [00:14<00:02, 31.22it/s]
Running loglikelihood requests:  87%|█████████████████████████████████████████████████████████████████████████████████████████▏             | 433/500 [00:15<00:02, 31.28it/s]
Running loglikelihood requests:  88%|██████████████████████████████████████████████████████████████████████████████████████████▊            | 441/500 [00:15<00:01, 31.26it/s]
Running loglikelihood requests:  90%|████████████████████████████████████████████████████████████████████████████████████████████▍          | 449/500 [00:15<00:01, 31.31it/s]
Running loglikelihood requests:  91%|██████████████████████████████████████████████████████████████████████████████████████████████▏        | 457/500 [00:15<00:01, 31.65it/s]
Running loglikelihood requests:  93%|███████████████████████████████████████████████████████████████████████████████████████████████▊       | 465/500 [00:16<00:01, 31.98it/s]
Running loglikelihood requests:  95%|█████████████████████████████████████████████████████████████████████████████████████████████████▍     | 473/500 [00:16<00:00, 32.17it/s]
Running loglikelihood requests:  96%|███████████████████████████████████████████████████████████████████████████████████████████████████    | 481/500 [00:16<00:00, 32.36it/s]
Running loglikelihood requests:  98%|████████████████████████████████████████████████████████████████████████████████████████████████████▋  | 489/500 [00:16<00:00, 32.68it/s]
Running loglikelihood requests:  99%|██████████████████████████████████████████████████████████████████████████████████████████████████████▍| 497/500 [00:16<00:00, 38.04it/s]
Running loglikelihood requests: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [00:16<00:00, 29.51it/s]
2024-11-30:19:44:51,742 INFO     [evaluation_tracker.py:206] Saving results aggregated
2024-11-30:19:44:51,748 INFO     [evaluation_tracker.py:287] Saving per-sample results for: leaderboard_bbh_formal_fallacies
